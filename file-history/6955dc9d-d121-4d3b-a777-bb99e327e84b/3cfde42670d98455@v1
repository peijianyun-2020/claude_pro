#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
货运邮件详细分析报告
"""

import json
from pathlib import Path

# 读取邮件数据
with open('cargo_email_full.json', 'r', encoding='utf-8') as f:
    email_data = json.load(f)

# 提取货物信息
cargo_a = {
    "编号": "A",
    "货物名称": "GYPSUM IN BULK",
    "货物中文名": "石膏（散装）",
    "数量": "10,000 MTS",
    "数量说明": "MIN/MAX (最小/最大)",
    "装货港": "PARADIP (帕拉迪普港, 印度)",
    "卸货港": "MONGLA (蒙格拉港, 孟加拉)",
    "装卸效率": "装港: 3,000吨/天 | 卸港: 2,000吨/天",
    "装卸条款": "PWWD SSHEX UU / PWWD FSHEX UU",
    "受载期": "10月6-10日",
    "佣金": "1.25% TTL",
    "紧急程度": "中（有固定受载期）"
}

cargo_b = {
    "编号": "B",
    "货物名称": "MANGANESE ORE",
    "货物中文名": "锰矿",
    "数量": "3,000-6,000 MTS",
    "数量说明": "范围可选",
    "装货港": "HALDIA (哈尔迪亚港, 印度)",
    "卸货港": "MONGLA (蒙格拉港, 孟加拉)",
    "装卸效率": "装港: 3,000吨/天 | 卸港: 2,000吨/天",
    "装卸条款": "PWWD SSHEX UU / PWWD FSHEX UU",
    "受载期": "SPOT (即期)",
    "佣金": "1.25% TTL",
    "紧急程度": "高（即期）"
}

cargo_c = {
    "编号": "C",
    "货物名称": "BOULDERS IN BULK",
    "货物中文名": "巨石（散装）",
    "数量": "15,000 MTS",
    "数量说明": "MIN MAX CHOPT (租方选择)",
    "装货港": "KAKINADA (卡基纳达港, 印度东海岸)",
    "卸货港": "MALE (马累港, 马尔代夫)",
    "装卸效率": "装港: 2,500吨/天 | 卸港: 1,500吨/天",
    "装卸条款": "PWWD SHINC / PWWD FHINC",
    "受载期": "2025年10月11-15日",
    "佣金": "2.50% TTL",
    "紧急程度": "中（有固定受载期）"
}

# 生成报告
report = f"""
{'='*100}
📦 货运邮件核心信息详细报告
{'='*100}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📧 邮件基本信息
{'─'*100}

│ 项目           │ 内容
│───────────────│───────────────────────────────────────────────────────────
│ 邮件主题       │ 10K GYPSUM EX PARADIP TO MONGLA // 3/6K MANGANESE ORE EX
│               │ HALDIA TO MONGLA // 15K BOULDERS KAKINADA TO MALE
│───────────────│───────────────────────────────────────────────────────────
│ 发件人         │ 简僤①dǐan <407002606@qq.com>
│───────────────│───────────────────────────────────────────────────────────
│ 收件人         │ dianli_pq <dianli_pq@qq.com>
│───────────────│───────────────────────────────────────────────────────────
│ 发送时间       │ 2026年1月9日 21:24:31 (GMT+8)
│───────────────│───────────────────────────────────────────────────────────
│ 原始发件人     │ 简僤①dǐan <407002606@qq.com>
│───────────────│───────────────────────────────────────────────────────────
│ 原始收件人     │ mc_shinson <mc_shinson@163.com>
│───────────────│───────────────────────────────────────────────────────────
│ 联系人         │ MANUEL
│───────────────│───────────────────────────────────────────────────────────
│ 手机           │ +91-9840446665 (印度)
│───────────────│───────────────────────────────────────────────────────────
│ Teams链接      │ https://teams.live.com/l/invite/FEAzPObb-Md6I7DyQY
│───────────────│───────────────────────────────────────────────────────────
│ 角色           │ AS BROKERS ONLY (仅作为经纪人)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📊 货物信息汇总表
{'─'*100}

┌──────────┬──────────────┬──────────────┬────────────────┬─────────────────┐
│ 编号     │ 货物类型     │ 货物名称     │ 数量(公吨)     │ 数量说明        │
├──────────┼──────────────┼──────────────┼────────────────┼─────────────────┤
│ A        │ 散装货物     │ 石膏         │ 10,000         │ 最小/最大       │
│ B        │ 矿石         │ 锰矿         │ 3,000-6,000    │ 范围可选        │
│ C        │ 散装货物     │ 巨石         │ 15,000         │ 租方选择        │
└──────────┴──────────────┴──────────────┴────────────────┴─────────────────┘

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🌍 港口航线信息表
{'─'*100}

┌──────────┬──────────────────────┬──────────────────────┬──────────────────┐
│ 编号     │ 装货港              │ 卸货港              │ 航线区域         │
├──────────┼──────────────────────┼──────────────────────┼──────────────────┤
│ A        │ PARADIP (印度)       │ MONGLA (孟加拉)      │ 印度→孟加拉      │
│ B        │ HALDIA (印度)        │ MONGLA (孟加拉)      │ 印度→孟加拉      │
│ C        │ KAKINADA (印度)      │ MALE (马尔代夫)      │ 印度→马尔代夫    │
└──────────┴──────────────────────┴──────────────────────┴──────────────────┘

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

⚡ 装卸效率对比表
{'─'*100}

┌──────────┬──────────────┬──────────────┬──────────────────────────────────┐
│ 编号     │ 装货港效率   │ 卸货港效率   │ 装卸条款说明                     │
├──────────┼──────────────┼──────────────┼──────────────────────────────────┤
│ A        │ 3,000吨/天   │ 2,000吨/天   │ PWWD SSHEX UU / PWWD FSHEX UU   │
│ B        │ 3,000吨/天   │ 2,000吨/天   │ PWWD SSHEX UU / PWWD FSHEX UU   │
│ C        │ 2,500吨/天   │ 1,500吨/天   │ PWWD SHINC / PWWD FHINC         │
└──────────┴──────────────┴──────────────┴──────────────────────────────────┘

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💰 商务条款对比表
{'─'*100}

┌──────────┬──────────────┬──────────────┬──────────────┬──────────────────┐
│ 编号     │ 受载期       │ 佣金         │ 紧急程度     │ 特殊条款         │
├──────────┼──────────────┼──────────────┼──────────────┼──────────────────┤
│ A        │ 10月6-10日   │ 1.25%        │ 中           │ 标准条款         │
│ B        │ SPOT(即期)   │ 1.25%        │ 高⚡         │ 需立即响应       │
│ C        │ 10月11-15日  │ 2.50%        │ 中           │ COA可协商        │
└──────────┴──────────────┴──────────────┴──────────────┴──────────────────┘

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📝 详细货物信息表
{'─'*100}

┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ 货物 A - 石膏散装                                                          ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

┌────────────────────────┬──────────────────────────────────────────────────┐
│ 项目                   │ 详细信息                                         │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 货物名称               │ GYPSUM IN BULK (石膏散装)                        │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 数量                   │ 10,000 MTS MIN/MAX (10,000公吨 最小/最大)       │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 装货港                 │ PARADIP (帕拉迪普港)                             │
│                        │ 印度东部奥里萨邦的主要港口                         │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 卸货港                 │ MONGLA (蒙格拉港)                                │
│                        │ 孟加拉国第二大港口                                │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 装货效率               │ 3,000 MTS PWWD SSHEX UU                          │
│                        │ 每天3,000公吨，工作日，周日/节假日除外           │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 卸货效率               │ 2,000 MTS PWWD FSHEX UU                          │
│                        │ 每天2,000公吨，工作日，周五/节假日除外           │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 受载期(LAYCAN)         │ 06TH - 10TH OCT (10月6-10日)                     │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 佣金(COMM)             │ 1.25% TTL (总佣金1.25%)                          │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 紧急程度               │ 中等 (有固定受载期窗口)                          │
└────────────────────────┴──────────────────────────────────────────────────┘

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ 货物 B - 锰矿                                                              ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

┌────────────────────────┬──────────────────────────────────────────────────┐
│ 项目                   │ 详细信息                                         │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 货物名称               │ MANGANESE ORE (锰矿)                             │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 数量                   │ 3K - 6K MTS (3,000-6,000公吨)                   │
│                        │ 数量可在范围内选择                                │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 装货港                 │ HALDIA (哈尔迪亚港)                              │
│                        │ 印度西孟加拉邦的主要港口                          │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 卸货港                 │ MONGLA (蒙格拉港)                                │
│                        │ 孟加拉国第二大港口                                │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 装货效率               │ 3,000 MTS PWWD SSHEX UU                          │
│                        │ 每天3,000公吨，工作日，周日/节假日除外           │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 卸货效率               │ 2,000 MTS PWWD FSHEX UU                          │
│                        │ 每天2,000公吨，工作日，周五/节假日除外           │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 受载期(LAYCAN)         │ SPOT (即期) ⚡                                   │
│                        │ 无固定受载期，需要立即安排                        │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 佣金(COMM)             │ 1.25% TTL (总佣金1.25%)                          │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 紧急程度               │ 高 (即期货物，需立即响应) ⚡⚡⚡                  │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 特殊说明               │ 数量灵活，可根据船况选择3K或6K                   │
└────────────────────────┴──────────────────────────────────────────────────┘

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ 货物 C - 巨石散装                                                          ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

┌────────────────────────┬──────────────────────────────────────────────────┐
│ 项目                   │ 详细信息                                         │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 货物名称               │ BOULDERS IN BULK (巨石散装)                      │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 数量                   │ 15,000 MTS MIN MAX CHOPT                         │
│                        │ 15,000公吨，数量由租方选择                       │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 装货港                 │ 1 SPB KAKINADA, ECI                              │
│                        │ 印度东海岸卡基纳达港，1个安全泊位                │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 卸货港                 │ 1 SPSA MALE, MALDIVES                            │
│                        │ 马尔代夫马累港，1个安全泊位/锚地                 │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 装货效率               │ 2,500 MTS PWWD SHINC                            │
│                        │ 每天2,500公吨，工作日包含节假日                  │
│                        │ 最小25吨安全工作负荷(SWL)                        │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 卸货效率               │ 1,500 MTS PWWD FHINC                            │
│                        │ 每天1,500公吨，工作日包含节假日                  │
│                        │ 最小25吨安全工作负荷(SWL)                        │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 受载期(LAYCAN)         │ 11TH - 15TH OCT, 2025                           │
│                        │ 2025年10月11-15日                                │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 佣金(COMM)             │ 2.50% TTL (总佣金2.50%)                          │
│                        │ 佣金比例较高                                      │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 紧急程度               │ 中等 (有固定受载期窗口)                          │
├────────────────────────┼──────────────────────────────────────────────────┤
│ 特殊条款               │ COA SHIPMENTS CAN BE WORKED OUT                  │
│                        │ 可协商COA(运输合同)安排                          │
└────────────────────────┴──────────────────────────────────────────────────┘

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📖 专业术语解释
{'─'*100}

│ 术语             │ 英文全称                         │ 中文含义                 │
│──────────────────│──────────────────────────────────│──────────────────────────│
│ PWWD             │ Per Weather Working Day         │ 每个工作日（天气允许）   │
│ SSHEX            │ Sundays & Holidays Excepted     │ 周日和节假日除外         │
│ FSHEX            │ Fridays & Holidays Excepted     │ 周五和节假日除外         │
│ SHINC            │ Sundays & Holidays Included     │ 周日和节假日包含         │
│ FHINC            │ Fridays & Holidays Included     │ 周五和节假日包含         │
│ UU               │ Unless Used                     │ 除非使用                 │
│ LAYCAN           │ Laydays & Cancelling Date       │ 受载期和解约日           │
│ SPOT             │ Spot Charter                    │ 即期租船                 │
│ COMM             │ Commission                      │ 佣金                     │
│ TTL              │ Total                           │ 总计                     │
│ CHOPT            │ Charterers Option               │ 租方选择                 │
│ COA              │ Contract of Affreightment       │ 运输合同                 │
│ SPB              │ Safe Berth/Port                 │ 安全泊位/港口             │
│ SPSA             │ Safe Port/Safe Anchorage        │ 安全港口/安全锚地        │
│ SWL              │ Safe Working Load               │ 安全工作负荷             │
│ MTS              │ Metric Tons                     │ 公吨                     │
│ MIN/MAX          │ Minimum/Maximum                 │ 最小/最大                │
│ ECI              │ East Coast of India             │ 印度东海岸               │

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💡 业务建议
{'─'*100}

1. 紧急程度排序：
   ⚡⚡⚡ 货物B (锰矿) - SPOT即期，需立即响应
   ⚡⚡   货物A (石膏) - 有固定受载期
   ⚡     货物C (巨石) - 有固定受载期

2. 佣金对比：
   - 货物A、B: 1.25% (标准佣金)
   - 货物C: 2.50% (较高佣金，可能是由于航线较长或港口条件特殊)

3. 装卸效率对比：
   - 货物A、B装卸效率相同且较高
   - 货物C装卸效率较低，但包含节假日作业

4. 港口区域：
   - 货物A、B: 印度→孟加拉航线
   - 货物C: 印度→马尔代夫航线

5. 建议优先联系：
   👉 首先联系货物B的经纪人，确认即期货物的可用性
   👉 同时评估货物A和C的船期匹配度

{'='*100}
✅ 报告生成完成
{'='*100}
"""

# 保存报告
with open('货运邮件详细报告.txt', 'w', encoding='utf-8') as f:
    f.write(report)

print(report)
print("\n报告已保存到: 货运邮件详细报告.txt")
