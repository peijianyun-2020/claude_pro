# Skill 测试指南

## 测试场景：采集20260101的实时现货价格

### 前置条件

1. 已安装本Skill到 `D:\AI\cc_pro\.claude\skills\southern-spot-price-collector`
2. 拥有南方区域现货电能量交易系统的有效账号
3. Chrome浏览器已安装

### 完整测试步骤

#### 步骤1：使用Claude对话测试（推荐）

在Claude Code中输入：

```
采集20260101的实时现货价格
```

Claude会自动：
1. 识别需要使用 `southern-spot-price-collector` skill
2. 加载SKILL.md中的指令
3. 打开Chrome浏览器访问交易系统
4. 引导你完成数据采集
5. 处理数据并生成CSV文件

#### 步骤2：手动测试脚本

如果需要手动测试，按以下步骤操作：

**2.1 访问交易系统**

```
网址：https://spot.poweremarket.com/uptspot/sr/mp/portaladmin/index.html#/
```

**2.2 登录系统**

- 输入用户名和密码
- 输入验证码
- 点击"登录"按钮

**2.3 打开Chrome DevTools**

- 按F12键
- 切换到"Network"（网络）标签
- 勾选"Preserve log"（保留日志）
- 筛选器设置为"XHR"

**2.4 触发API请求**

1. 在系统中找到"用电侧成交价格"模块
2. 点击切换到"实时"标签（dateType="1"）
3. 在日期选择器中选择"2026-01-01"
4. 等待数据加载

**2.5 提取API数据**

1. 在Network标签中搜索：`getWatchUserPriceData`
2. 点击该请求
3. 切换到"Response"（响应）标签
4. 全选数据（Ctrl+A）
5. 复制数据（Ctrl+C）

**2.6 处理数据**

编辑 `scripts/process_spot_price.py`:

```python
# 找到这一行，将复制的JSON数据粘贴进去
api_data = {
    "code": 0,
    "msg": "success",
    "data": [
        # 粘贴完整的data数组内容
    ]
}

# 修改目标日期
target_date = "2026-01-01"
data_type = "realtime"
```

运行脚本：

```bash
cd D:\AI\cc_pro\.claude\skills\southern-spot-price-collector\scripts
python process_spot_price.py
```

**2.7 验证输出**

脚本会在 `D:\AI\cc_pro\现货价格采集\` 目录生成：

```
实时价格_20260101.csv
```

文件内容应包含：
- 标题行：时间,全区域,广东,广西,云南,贵州,海南
- 24行数据（00:00 - 23:00）
- 每行7个值

### 预期输出示例

```csv
时间,全区域,广东,广西,云南,贵州,海南
00:00,371.7845,387.849,373.3411,249.8317,438.4059,449.9766
01:00,348.1993,361.7443,331.3694,204.2519,425.8183,500.0455
...
23:00,420.5342,440.1234,425.6789,300.2345,490.5678,510.7890
```

### 验证清单

测试完成后，确认：

- [ ] Skill被Claude正确识别
- [ ] CSV文件成功生成
- [ ] 文件包含24行数据
- [ ] 所有6个地区都有数据
- [ ] 价格值合理（非负、非异常大）
- [ ] 文件命名正确：`实时价格_20260101.csv`
- [ ] 文件保存在正确目录：`D:\AI\cc_pro\现货价格采集\`

### 常见问题排查

**Q1: Claude没有识别skill？**

检查：
- Skill目录结构是否正确
- SKILL.md文件是否存在
- YAML frontmatter格式是否正确

**Q2: 无法登录系统？**

确认：
- 用户名和密码正确
- 网络连接正常
- 验证码输入正确

**Q3: 找不到API接口？**

确保：
- 已点击"用电侧成交价格"模块
- Network筛选器设置为"XHR"
- 已勾选"Preserve log"
- 已选择正确的日期和数据类型

**Q4: CSV文件乱码？**

使用以下方式之一：
- Excel：数据 → 从文本/CSV → 选择UTF-8编码
- 记事本/VSCode直接打开
- 脚本已使用utf-8-sig编码

**Q5: 数据不完整？**

检查：
- 目标日期是否有数据
- API响应是否完整
- 所有地区代码都存在

### 测试成功标志

如果看到以下输出，说明测试成功：

```
==============================================================
✅ 数据保存成功!
==============================================================
📁 文件路径: D:\AI\cc_pro\现货价格采集\实时价格_20260101.csv
📅 目标日期: 2026-01-01
🏷️  数据类型: 实时价格
📊 数据行数: 24 行 (24小时)
📋 缺失数据: 0 个值
==============================================================
✨ 数据完整性: 完美! 所有时段和地区的数据齐全
```

### 后续测试

完成基本测试后，可以测试：

1. **日前数据采集**
   ```
   采集20260101的日前价格
   ```

2. **批量采集**
   ```
   采集2026年1月1日到1月3日的实时数据
   ```

3. **历史数据**
   ```
   采集2025年12月31日的实时价格
   ```

### 技术支持

如果测试失败，请：

1. 检查 `SKILL.md` 中的详细说明
2. 查看 `README.md` 中的常见问题
3. 查阅 `现货价格采集` 目录下的参考文档
4. 验证Python环境和浏览器设置

---

**测试记录模板**

```
测试日期：____________________
测试人员：____________________
Skill版本：v1.0
测试场景：采集20260101实时现货价格

测试结果：
☐ 成功  ☐ 失败

问题描述（如失败）：
_________________________________________
_________________________________________

备注：
_________________________________________
```
