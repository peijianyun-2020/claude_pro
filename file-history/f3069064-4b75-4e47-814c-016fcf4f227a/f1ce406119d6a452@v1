# 微信公众号采集 Skill - 用户使用指南

## 🎯 这是什么？

这是一个**用户级技能(Skill)**，可以让你在Claude Code中轻松采集微信公众号文章。

## 🚀 快速开始

### 最简单的使用方式

直接在Claude Code对话中给一个微信文章链接：

```
https://mp.weixin.qq.com/s/5cuBvvdfHuunxzW825fNHA
```

或者用自然语言：

```
请帮我采集这篇微信文章：https://mp.weixin.qq.com/s/5cuBvvdfHuunxzW825fNHA
```

就这么简单！系统会自动：
1. 识别微信文章链接
2. 打开文章页面
3. 提取标题、作者、公众号、发布时间
4. 获取文章正文
5. 转换为Markdown格式
6. 下载图片（可选）
7. 保存到本地

## 📝 更多使用方式

### 1. 采集单篇文章

```
请采集这篇微信文章：https://mp.weixin.qq.com/s/xxx
```

### 2. 采集并下载图片

```
帮我采集这篇文章并下载图片：https://mp.weixin.qq.com/s/xxx
```

### 3. 批量采集

```
批量采集这些文章：
- https://mp.weixin.qq.com/s/xxx1
- https://mp.weixin.qq.com/s/xxx2
- https://mp.weixin.qq.com/s/xxx3
```

或者直接给一个列表：

```
采集这些文章：https://mp.weixin.qq.com/s/xxx1, https://mp.weixin.qq.com/s/xxx2, https://mp.weixin.qq.com/s/xxx3
```

### 4. 采集相关文章

```
从这篇文章采集所有相关文章：https://mp.weixin.qq.com/s/xxx
```

## 📂 文件保存位置

采集的文章会保存在：`./wechat_articles/`

```
wechat_articles/
└── 走进电力市场/                          # 按公众号名称分类
    ├── 2026-01-04_文章标题.md              # Markdown文件
    ├── 2026-01-04_文章标题_metadata.json   # 元数据
    └── images/                            # 图片目录
        ├── 001.png
        ├── 002.jpg
        └── ...
```

## 📄 输出格式

### Markdown文件示例

```markdown
# 《电力中长期市场基本规则》解读：总则和总体要求

**元数据**

- **作者**: 荆朝霞
- **公众号**: 走进电力市场
- **发布时间**: 2026年1月4日 11:16
- **原文链接**: https://mp.weixin.qq.com/s/5cuBvvdfHuunxzW825fNHA
- **图片数量**: 5

---

引言：2025年12月17日，新一版的《电力中长期市场基本规则》正式发布...

【解读】...
```

### 元数据JSON示例

```json
{
  "title": "《电力中长期市场基本规则》解读：总则和总体要求",
  "author": "荆朝霞",
  "account_name": "走进电力市场",
  "publish_time": "2026年1月4日 11:16",
  "url": "https://mp.weixin.qq.com/s/5cuBvvdfHuunxzW825fNHA",
  "image_count": 5,
  "images": [
    "https://mmbiz.qpic.cn/...",
    "https://mmbiz.qpic.cn/..."
  ],
  "collected_at": "2026-01-13T10:30:00"
}
```

## ⚙️ 配置选项

可以修改 `config.py` 来自定义行为：

```python
# 存储配置
OUTPUT_DIR = "./wechat_articles"  # 输出目录
DOWNLOAD_IMAGES = True            # 默认下载图片

# 文件命名
FILE_FORMAT = "{date}_{title}.md"  # 日期_标题.md

# 采集速度
DELAY_BETWEEN_REQUESTS = 2        # 请求间隔（秒）
```

## 🎨 使用场景

### 场景1：学习资料收集
```
我正在学习电力市场，帮我采集"走进电力市场"公众号的这些文章：
[链接列表]
```

### 场景2：内容归档
```
帮我把这篇文章保存下来，怕以后被删：https://mp.weixin.qq.com/s/xxx
```

### 场景3：批量下载
```
我需要离线阅读这些文章，帮我全部采集并下载图片：
[链接列表]
```

### 场景4：知识管理
```
采集这些技术文章，我要建立知识库：https://mp.weixin.qq.com/s/xxx
```

## 💡 技巧和建议

1. **批量采集时**：建议每10-20篇为一组，避免一次性采集太多
2. **图片下载**：如果只需要文字，可以跳过图片下载，速度更快
3. **存储空间**：批量采集前确保有足够的磁盘空间
4. **网络稳定**：采集过程中保持网络稳定，避免中断

## ⚠️ 注意事项

1. **版权声明**：仅供个人学习使用，请勿用于商业用途
2. **采集速度**：单篇文章约需10-30秒，请耐心等待
3. **网络要求**：需要能正常访问微信公众号
4. **图片版权**：下载的图片仅供学习，注意版权

## 🐛 常见问题

**Q: 为什么有些文章采集失败？**
A: 可能是网络问题或文章已删除，系统会自动重试3次。

**Q: 图片下载失败怎么办？**
A: 系统会跳过失败的图片，不影响文章内容保存。

**Q: 可以采集整个公众号的历史文章吗？**
A: 需要提供文章链接列表，未来版本可能会支持自动获取历史文章。

**Q: 采集的文章在哪里？**
A: 默认在 `./wechat_articles/` 目录，按公众号分类。

## 📚 技术原理

本技能基于以下技术：
- **Chrome DevTools MCP**：使用真实浏览器访问
- **BeautifulSoup**：解析HTML内容
- **Markdownify**：转换为Markdown格式
- **Requests**：下载图片

优势：
- ✅ 无需处理反爬虫
- ✅ 自动渲染JavaScript
- ✅ 简单可靠
- ✅ 支持交互操作

## 🎉 开始使用

现在就开始！给我一个微信文章链接：

```
https://mp.weixin.qq.com/s/[你的文章链接]
```

---

**有任何问题或建议，欢迎反馈！** 📧
