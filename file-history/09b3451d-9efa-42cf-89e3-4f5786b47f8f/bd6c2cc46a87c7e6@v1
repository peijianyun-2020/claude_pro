# 南方区域电力现货价格自动化采集技能

## 技能概述

这是一个 Claude Code 技能（skill），用于**自动化采集**南方区域电力现货价格数据。无需手动复制 JSON 数据，全程自动化操作。

## 核心改进

### v2.0 新功能 ✨

1. **全自动采集流程**
   - 自动打开交易系统
   - 自动导航到用电侧成交价格模块
   - 自动选择日期和数据类型
   - 自动提取 API 响应数据
   - 自动生成 CSV 文件

2. **Chrome DevTools 集成**
   - 使用 MCP 工具直接控制浏览器
   - 智能页面导航和元素交互
   - 自动捕获网络请求

3. **数据验证和备份**
   - 自动检查数据完整性
   - 自动保存 API 原始数据备份
   - 自动生成统计报告

## 使用方式

### 直接调用（推荐）

直接告诉 Claude Code 您的需求：

```
采集2026-01-11的日前价格
提取最近7天的实时数据
获取2025年12月的所有日前价格
```

Claude Code 会自动：
1. 打开交易系统
2. 等待您登录（首次需要）
3. 自动采集数据
4. 生成 CSV 文件
5. 返回结果

### 交互式使用

```
我要采集现货价格
```

Claude Code 会询问：
- 目标日期
- 数据类型（日前/实时）

然后自动执行采集。

## 文件说明

```
xianhuoprice/
├── SKILL.md                     # 技能完整文档（供 Claude Code 参考）
├── README.md                    # 本文件（用户使用指南）
├── TEST_GUIDE.md                # 测试指南
└── scripts/
    ├── auto_collect_spot_price.py    # 自动化采集脚本
    └── process_spot_price.py         # 数据处理工具
```

## 采集流程

```
1. Claude Code 打开交易系统
   ↓
2. 提示用户手动登录（仅需首次）
   ↓
3. 用户回复"已登录"
   ↓
4. Claude Code 自动执行：
   - 导航到"用电侧成交价格"模块
   - 选择数据类型（日前/实时）
   - 设置目标日期
   - 提取 API 数据
   ↓
5. 验证数据并生成 CSV
   ↓
6. 返回采集结果和文件路径
```

## 输出文件

### CSV 数据文件
```
D:\AI\cc_pro\现货价格采集\
├── 实时价格_20260111.csv
└── 日前价格_20260111.csv
```

### API 备份文件
```
D:\AI\cc_pro\现货价格采集\backups\
├── api_backup_realtime_20260111.json
└── api_backup_dayahead_20260111.json
```

## 示例对话

### 示例1：采集单日数据
```
用户：采集2026-01-11的日前价格

Claude：好的，我来帮您采集 2026-01-11 的日前价格数据。

[打开交易系统...]

Claude：请在浏览器中完成登录操作，登录后回复"已登录"

用户：已登录

Claude：收到！现在开始自动采集...

[自动导航、选择日期、提取数据...]

Claude：✅ 采集成功！
📁 文件路径: D:\AI\cc_pro\现货价格采集\日前价格_20260111.csv
📊 数据行数: 24行
✅ 数据完整性: 完美
```

### 示例2：批量采集
```
用户：采集最近3天的实时数据

Claude：好的，我来采集最近3天（2026-01-08, 2026-01-09, 2026-01-10）的实时价格数据。

[依次采集每一天...]

Claude：✅ 批量采集完成！
📁 采集文件: 3个
✅ 成功: 3个
❌ 失败: 0个

文件列表：
- 实时价格_20260108.csv
- 实时价格_20260109.csv
- 实时价格_20260110.csv
```

### 示例3：数据未生成
```
用户：采集2026-01-12的日前价格

Claude：⚠️ 数据尚未生成

原因分析：
- API返回: {"code":0,"msg":"success","data":[]}
- data字段为空，表示2026-01-12的日前数据尚未发布

可能原因：
1. 日期过早（如明天），数据还未生成
2. 数据通常在运行日前一天深夜发布

建议：
1. 采集2026-01-11的日前价格
2. 或稍后重试2026-01-12的数据
```

## 技术要求

- **Claude Code** - 支持 MCP 工具
- **Chrome DevTools MCP** - 浏览器自动化服务
- **Chrome 浏览器** - 访问交易系统
- **网络连接** - 互联网访问

## 注意事项

1. **登录要求**
   - 首次使用需要手动登录
   - 登录后会在一段时间内保持有效

2. **数据可用性**
   - 日前数据：通常在运行日前一天深夜发布
   - 实时数据：在运行日结束后才完整

3. **采集时机**
   - 避免在系统高峰时段（上午9-11点）采集
   - 建议在下午或晚上进行批量采集

## 常见问题

**Q: 需要手动复制 JSON 数据吗？**
A: 不需要！v2.0 版本全自动采集，无需任何手动操作（除了登录）。

**Q: 可以批量采集多日数据吗？**
A: 可以！只需说"采集最近N天的数据"即可。

**Q: 如果数据还没发布怎么办？**
A: 系统会自动检测并提示，建议采集其他日期。

**Q: 生成的 CSV 文件在哪里？**
A: 默认保存在 `D:\AI\cc_pro\现货价格采集\` 目录。

## 版本历史

### v2.0 (2026-01-11)
- ✨ 新增全自动采集功能
- ✨ Chrome DevTools 集成
- ✨ 自动数据验证和备份
- 📝 更新文档

### v1.0 (2025-01-03)
- 初始版本
- 需要手动复制 JSON 数据

## 支持

如遇问题，请查看：
- `SKILL.md` - 完整技能文档
- `TEST_GUIDE.md` - 测试指南

---

**现在就开始使用吧！直接告诉 Claude Code："采集今天的日前价格"** 🚀
